# NapCat QQ æœºå™¨äºº

ä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„ QQ æœºå™¨äººï¼ŒåŸºäº NapCat å®ç°ï¼Œæ”¯æŒ AI å›å¤å’Œ Bç«™å†…å®¹è§£æã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ”Œ **NapCat è¿æ¥** - é€šè¿‡ WebSocket è¿æ¥ NapCatï¼Œå®æ—¶æ¥æ”¶ç¾¤æ¶ˆæ¯
- ğŸ¤– **æ™ºèƒ½ AI å›å¤** - æ”¯æŒ @è§¦å‘ å’Œ è‡ªå®šä¹‰æ¦‚ç‡è§¦å‘
- ğŸ“º **Bç«™å†…å®¹è§£æ** - è‡ªåŠ¨è¯†åˆ«å¹¶è§£æ Bç«™è§†é¢‘ã€åŠ¨æ€ã€ä¸“æ ã€ç•ªå‰§é“¾æ¥
- ğŸ–¼ï¸ **ç²¾ç¾å¡ç‰‡ç”Ÿæˆ** - å°† Bç«™å†…å®¹è½¬åŒ–ä¸ºç²¾ç¾çš„å›¾ç‰‡å¡ç‰‡
- ğŸ“ **å®Œæ•´æ—¥å¿—ç³»ç»Ÿ** - æ”¯æŒæ§åˆ¶å°å’Œæ–‡ä»¶æ—¥å¿—è¾“å‡º

## ğŸ“‹ æ”¯æŒçš„ Bç«™å†…å®¹ç±»å‹

| ç±»å‹ | ç¤ºä¾‹é“¾æ¥ | å¡ç‰‡å†…å®¹ |
|------|---------|---------|
| **è§†é¢‘** | `bilibili.com/video/BV1xx411c7XZ` | å°é¢ã€æ ‡é¢˜ã€UPä¸»ã€æ—¶é•¿ã€æ’­æ”¾/ç‚¹èµ/æ”¶è—æ•° |
| **åŠ¨æ€** | `t.bilibili.com/123456789` | UPä¸»ã€å‘å¸ƒæ—¶é—´ã€å†…å®¹ã€å›¾ç‰‡ã€è½¬å‘/ç‚¹èµ/è¯„è®ºæ•° |
| **ä¸“æ ** | `bilibili.com/read/cv12345` | å°é¢ã€æ ‡é¢˜ã€ä½œè€…ã€ç®€ä»‹ã€é˜…è¯»/ç‚¹èµæ•° |
| **ç•ªå‰§** | `bilibili.com/bangumi/play/ss12345` | å°é¢ã€æ ‡é¢˜ã€è¯„åˆ†ã€ç®€ä»‹ã€æ’­æ”¾/è¿½ç•ªæ•° |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js >= 18.0.0
- NapCat å·²å®‰è£…å¹¶è¿è¡Œ
- ä¸€ä¸ªå¯ç”¨çš„ AI API æ¥å£

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <your-repo-url>
cd napcat-qq-bot
```

2. **å®‰è£…ä¾èµ–**
```bash
npm install
```

3. **é…ç½®æœºå™¨äºº**

**é¦–å…ˆè·å– Bç«™ Cookieï¼ˆæ¨èä½¿ç”¨æ‰«ç ç™»å½•ï¼‰ï¼š**

```bash
npm run login
```

ç„¶åç¼–è¾‘ `src/config.js`ï¼Œå¡«å…¥ä½ çš„é…ç½®ä¿¡æ¯ï¼š

```javascript
export default {
  napcat: {
    host: 'localhost',
    port: 3001  // NapCat WebSocket ç«¯å£
  },
  
  bot: {
    qq: 'ä½ çš„æœºå™¨äººQQå·',
    ai: {
      atTrigger: true,  // æ˜¯å¦å¯ç”¨@è§¦å‘
      randomTriggerProbability: 0.1,  // éšæœºè§¦å‘æ¦‚ç‡(0-1)
      apiUrl: 'http://your-ai-api.com/chat',  // AI API åœ°å€
      apiKey: 'your-api-key'  // AI API å¯†é’¥
    }
  },
  
  bilibili: {
    cookie: 'your_bilibili_cookie'  // Bç«™Cookie(å¯é€‰)
  }
}
```

4. **å¯åŠ¨æœºå™¨äºº**
```bash
npm start
```

å¼€å‘æ¨¡å¼(è‡ªåŠ¨é‡å¯)ï¼š
```bash
npm run dev
```

## âš™ï¸ é…ç½®è¯´æ˜

### NapCat é…ç½®

ç¡®ä¿ NapCat çš„ WebSocket æœåŠ¡å·²å¯åŠ¨ï¼Œé»˜è®¤ç«¯å£ä¸º 3001ã€‚

ä¿®æ”¹ NapCat çš„é…ç½®æ–‡ä»¶ `config/onebot11.json`ï¼š
```json
{
  "ws": {
    "enable": true,
    "host": "0.0.0.0",
    "port": 3001
  }
}
```

### AI API é…ç½®

æ”¯æŒä»»ä½•ç¬¦åˆä»¥ä¸‹æ ¼å¼çš„ AI APIï¼š

**è¯·æ±‚æ ¼å¼ï¼š**
```json
{
  "model": "æ¨¡å‹åç§°",
  "messages": [
    {
      "role": "user",
      "content": "ç”¨æˆ·æ¶ˆæ¯"
    }
  ]
}
```

**å“åº”æ ¼å¼ï¼ˆæ”¯æŒä»¥ä¸‹ä»»ä¸€ï¼‰ï¼š**
```json
{
  "choices": [
    {
      "message": {
        "content": "AIå›å¤å†…å®¹"
      }
    }
  ]
}
```
æˆ–
```json
{
  "response": "AIå›å¤å†…å®¹"
}
```

### Bç«™ Cookie è·å–

#### æ–¹æ³•ä¸€ï¼šæ‰«ç ç™»å½•ï¼ˆæ¨èï¼‰

è¿è¡Œç™»å½•è„šæœ¬ï¼Œä½¿ç”¨ Bilibili APP æ‰«ç ç™»å½•ï¼š

```bash
npm run login
```

è„šæœ¬ä¼šï¼š
1. åœ¨ç»ˆç«¯æ˜¾ç¤ºäºŒç»´ç 
2. ç­‰å¾…ä½ ç”¨ Bç«™ APP æ‰«ç ç¡®è®¤
3. è‡ªåŠ¨è·å– Cookie å¹¶ä¿å­˜åˆ°é…ç½®æ–‡ä»¶
4. éªŒè¯ Cookie æ˜¯å¦æœ‰æ•ˆ

#### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨è·å–

1. æµè§ˆå™¨æ‰“å¼€ bilibili.com å¹¶ç™»å½•
2. æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
3. åˆ‡æ¢åˆ° Network æ ‡ç­¾
4. åˆ·æ–°é¡µé¢ï¼Œæ‰¾åˆ°ä»»æ„è¯·æ±‚
5. å¤åˆ¶ Request Headers ä¸­çš„ Cookie å€¼

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### 1. AI å›å¤è§¦å‘

**@è§¦å‘ï¼š**
```
@æœºå™¨äºº ä½ å¥½
```

**éšæœºè§¦å‘ï¼š**
```
ä»Šå¤©å¤©æ°”çœŸå¥½
(æœ‰ 10% æ¦‚ç‡è§¦å‘ AI å›å¤)
```

### 2. Bç«™å†…å®¹è§£æ

å‘é€åŒ…å« Bç«™é“¾æ¥çš„æ¶ˆæ¯ï¼š
```
https://www.bilibili.com/video/BV1xx411c7XZ
```

æˆ–è€…åˆ†äº« Bç«™å°ç¨‹åºï¼Œæœºå™¨äººä¼šè‡ªåŠ¨è¯†åˆ«å¹¶ç”Ÿæˆç²¾ç¾å¡ç‰‡ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
napcat-qq-bot/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ bot.js                    # æœºå™¨äººä¸»å…¥å£
â”‚   â”œâ”€â”€ config.js                 # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ handlers/
â”‚   â”‚   â”œâ”€â”€ messageHandler.js    # æ¶ˆæ¯å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ biliHandler.js        # Bç«™å†…å®¹å¤„ç†
â”‚   â”‚   â””â”€â”€ aiHandler.js          # AIå›å¤å¤„ç†
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ biliApi.js            # Bç«™APIæœåŠ¡
â”‚   â”‚   â””â”€â”€ imageGenerator.js    # å›¾ç‰‡ç”ŸæˆæœåŠ¡
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ urlParser.js          # URLè§£æå·¥å…·
â”‚       â””â”€â”€ logger.js             # æ—¥å¿—å·¥å…·
â”œâ”€â”€ temp/                         # ä¸´æ—¶å›¾ç‰‡æ–‡ä»¶
â”œâ”€â”€ logs/                         # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

## ğŸ”§ é«˜çº§åŠŸèƒ½

### è‡ªå®šä¹‰è§¦å‘æ¦‚ç‡

åœ¨ `config.js` ä¸­è°ƒæ•´ `randomTriggerProbability`ï¼š
```javascript
randomTriggerProbability: 0.2  // 20% æ¦‚ç‡
```

### ç®¡ç†å‘˜å‘½ä»¤

å¯ä»¥åœ¨ `config.js` ä¸­é…ç½®ç®¡ç†å‘˜ QQï¼š
```javascript
admins: ['12345678', '87654321']
```

### æ—¥å¿—çº§åˆ«

è°ƒæ•´æ—¥å¿—è¾“å‡ºçº§åˆ«ï¼š
```javascript
logging: {
  level: 'debug',  // debug | info | warn | error
  saveToFile: true,
  logPath: './logs'
}
```

## ğŸ› å¸¸è§é—®é¢˜

### 1. æ— æ³•è¿æ¥åˆ° NapCat

- æ£€æŸ¥ NapCat æ˜¯å¦æ­£åœ¨è¿è¡Œ
- ç¡®è®¤ WebSocket ç«¯å£é…ç½®æ­£ç¡®
- æŸ¥çœ‹ NapCat æ—¥å¿—æ˜¯å¦æœ‰é”™è¯¯

### 2. AI ä¸å›å¤

- æ£€æŸ¥ AI API åœ°å€æ˜¯å¦æ­£ç¡®
- éªŒè¯ API Key æ˜¯å¦æœ‰æ•ˆ
- æŸ¥çœ‹æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯

### 3. Bç«™å†…å®¹è§£æå¤±è´¥

- ç¡®è®¤é“¾æ¥æ ¼å¼æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ Bç«™ Cookie æ˜¯å¦è¿‡æœŸ
- æŸäº›å†…å®¹å¯èƒ½éœ€è¦ç™»å½•æ‰èƒ½è·å–

### 4. å›¾ç‰‡ç”Ÿæˆå¤±è´¥

- ç¡®ä¿ Puppeteer ä¾èµ–å·²æ­£ç¡®å®‰è£…
- Linux ç³»ç»Ÿå¯èƒ½éœ€è¦å®‰è£…é¢å¤–ä¾èµ–ï¼š
```bash
sudo apt-get install -y chromium-browser
```

## ğŸ“ å¾…åŠäº‹é¡¹

- [ ] æ”¯æŒçŸ­é“¾æ¥(b23.tv)å±•å¼€
- [ ] æ·»åŠ æ›´å¤š Bç«™å†…å®¹ç±»å‹æ”¯æŒ
- [ ] å®ç°ä¼šè¯ä¸Šä¸‹æ–‡ç®¡ç†
- [ ] æ·»åŠ ç¾¤èŠç®¡ç†åŠŸèƒ½
- [ ] æ”¯æŒæ›´å¤š AI æ¨¡å‹

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ™ è‡´è°¢

- [NapCat](https://github.com/NapNeko/NapCatQQ) - ä¼˜ç§€çš„ QQ æœºå™¨äººæ¡†æ¶
- [Colter23/bilibili-dynamic-mirai-plugin](https://github.com/Colter23/bilibili-dynamic-mirai-plugin) - Bç«™è§£æå‚è€ƒ

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œæ¬¢è¿é€šè¿‡ Issue è”ç³»ï¼